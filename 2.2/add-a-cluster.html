


<!doctype html>
<html class="no-js" lang="en">
  
<head><!-- begin head.html -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
    Add a Cluster | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server."/>

    <link rel="icon" href="_static/img/favicon.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://docs.scylladb.com/">

    <link rel="author" href="mailto:info@scylladb.com">
    <link rel="stylesheet" href="_static/" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_tabs/tabs.css" />
    
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>

    <script src="_static/js/vendor/modernizr.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8P2JP');</script>
    <!-- End Google Tag Manager -->

    <!-- Marketo -->
    <script type="text/javascript"> (function() { var didInit = false; function initMunchkin() { if(didInit === false) { didInit = true; Munchkin.init('791-QBF-350'); } } var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//munchkin.marketo.net/munchkin.js'; s.onreadystatechange = function() { if (this.readyState == 'complete' || this.readyState == 'loaded') { initMunchkin(); } }; s.onload = initMunchkin; document.getElementsByTagName('head')[0].appendChild(s); })(); </script>
    <!-- End Marketo -->

<!-- end head.html -->
</head>

<body>


    <section class="custom-promo-banner-wrap">
    <div class="custom-promo-banner--relative">
        <div class="custom-promo-banner--img-left">
            <img src="_static/img/Scylla-Summit-Banner-globs-left.svg">
        </div>
        <div class="custom-promo-banner--img-center">
            <img src="_static/img/Scylla-Summit-Banner-globs-middle.svg">
        </div>
        <div class="custom-promo-banner--img-right">
            <img src="_static/img/Scylla-Summit-Banner-globs-right.svg">
        </div>

        <div class="custom-promo-banner">
            <img class="custom-promo-banner--logo" src="_static/img/slide-summit21-logo@2x.png" alt="">
            <div class="custom-promo-banner--title summit">Database Monsters of the World Connect! Virtual Conference | January 12-14</div>
            <a class="custom-promo-banner--button summit" href="https://scylladb.com/scylla-summit-2021/">Register Now <i class="fa fa-angle-right" style="margin-left: 10px;" aria-hidden="true"></i></a><button class="custom-promo-banner--close">×</button>
        </div>
    </div>
</section>



<header id="header" class="animated">
    <div class="topbar_continer contain-to-grid clearfix">
        <nav class="top-bar" id="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <div class="logo">
                        <a href="https://docs.scylladb.com/"><img src="_static/img/logo-scylla-docs.svg" alt="" width="151"></a>
                    </div>
                </li>
                <li class="toggle-topbar"><a href="#"><span class="icon-manu"></span></a></li>
            </ul>
            <section class="top-bar-section clearfix">
                <ul class="right">
                    
                    <li>
                        <a href="https://scylladb.github.io/scylla-manager/">Scylla Manager</a>
                    </li>
                    
                    <li>
                        <a href="https://scylladb.github.io/scylla-monitoring/">Scylla Monitor</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">Scylla Cloud</a>
                    </li>
                    
                    <li>
                        <a href="https://university.scylladb.com/">Scylla University</a>
                    </li>
                    
                    <li>
                        <a href="https://www.scylladb.com/">ScyllaDB Home</a>
                    </li>
                    
                    <li class="search_continer show-for-medium-up">	
                        <ci-search></ci-search>	
                    </li>	
                </ul>
            </section>
        </nav>
    </div>
</header>
<section id="content">
    <div class="row">
	
	<div class="large-6 large-push-3 columns">

        

        <div class="section" id="add-a-cluster">
<h1>Add a Cluster<a class="headerlink" href="#add-a-cluster" title="Permalink to this headline">¶</a></h1>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p>Scylla Manager Agent is up and running on all Scylla nodes.</p></li>
<li><p>All the Agents have the same <a class="reference internal" href="install-scylla-manager-agent.html#configure-auth-token"><span class="std std-ref">authentication token</span></a> configured.</p></li>
<li><p>Traffic on the following ports is unblocked from the Scylla Manager Server to all the Scylla nodes.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">10001</span></code> - Scylla Manager Agent REST API (HTTPS)</p></li>
<li><p>CQL port (typically <code class="docutils literal notranslate"><span class="pre">9042</span></code>) - required for CQL health check status reports</p></li>
</ul>
</li>
</ul>
<p id="add-cluster"><strong>Procedure</strong></p>
<ol class="arabic">
<li><p>From the Scylla Manager Server, provide the IP address of one of the nodes, the generated auth token, and a custom name.</p>
<p>Example (IPv4):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool cluster add --host 34.203.122.52 --name prod-cluster \
--auth-token &quot;6Es3dm24U72NzAu9ANWmU3C4ALyVZhwwPZZPWtK10eYGHJ24wMoh9SQxRZEluWMc0qDrsWCCshvfhk9uewOimQS2x5yNTYUEoIkO1VpSmTFu5fsFyoDgEkmNrCJpXtfM&quot;

c1bbabf3-cad1-4a59-ab8f-84e2a73b623f
 __
/  \     Cluster added! You can set it as default, by exporting env variable.
@  @     $ export SCYLLA_MANAGER_CLUSTER=c1bbabf3-cad1-4a59-ab8f-84e2a73b623f
|  |     $ export SCYLLA_MANAGER_CLUSTER=prod-cluster
|| |/
|| ||    Now run:
|\_/|    $ sctool status -c prod-cluster
\___/    $ sctool task list -c prod-cluster
</pre></div>
</div>
<p>Example (IPv6):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool cluster add --host 2a05:d018:223:f00:971d:14af:6418:fe2d --name prod-cluster \
--auth-token &quot;6Es3dm24U72NzAu9ANWmU3C4ALyVZhwwPZZPWtK10eYGHJ24wMoh9SQxRZEluWMc0qDrsWCCshvfhk9uewOimQS2x5yNTYUEoIkO1VpSmTFu5fsFyoDgEkmNrCJpXtfM&quot;
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--host</span></code> is hostname or IP of one of the cluster nodes. You can use an IPv6 or an IPv4 address.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--name</span></code> is an alias you can give to your cluster.
Using an alias means you do not need to use the ID of the cluster in all other operations.
This name must be used when connecting the managed cluster to Scylla Monitor, but does not have to be the same name you used in scylla.yaml.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--auth-token</span></code> is the <a class="reference internal" href="install-scylla-manager-agent.html#configure-auth-token"><span class="std std-ref">authentication token</span></a> you generated.</p></li>
</ul>
<p>Each cluster has a unique ID (UUID), you will see it printed to stdout in <code class="docutils literal notranslate"><span class="pre">sctool</span> <span class="pre">cluster</span> <span class="pre">add</span></code> output when the cluster is added.
You will use this ID in all commands where the cluster ID is required.
Alternatively you can use the name you assigned to the cluster instead of the ID.
You can also set a custom UUID using <code class="docutils literal notranslate"><span class="pre">--id</span> <span class="pre">&lt;my-UUID&gt;</span></code> flag.</p>
<p>Each cluster is automatically registered with a repair task which runs once a week.
This can be canceled using <code class="docutils literal notranslate"><span class="pre">--without-repair</span></code>.
To use a different repair schedule, see <a class="reference internal" href="repair/examples.html#schedule-a-repair"><span class="std std-ref">Schedule a Repair</span></a>.</p>
<p>Optionally you can provide CQL credentials to the cluster with <code class="docutils literal notranslate"><span class="pre">--username</span></code> and <code class="docutils literal notranslate"><span class="pre">--password</span></code> flags.
This enables <a class="reference internal" href="health-check.html#cql-query-health-check"><span class="std std-ref">CQL query based health check</span></a> compared to <a class="reference internal" href="health-check.html#credentials-agnostic-health-check"><span class="std std-ref">credentials agnostic health check</span></a> if you do not specify the credentials.
This also enables CQL schema backup in text format, which isn’t performed if credentials aren’t provided.
For security reasons the CQL user should NOT have access to read your data.</p>
</li>
<li><p>Verify the cluster you added has a registered repair task by running the <code class="docutils literal notranslate"><span class="pre">sctool</span> <span class="pre">task</span> <span class="pre">list</span></code> command.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool task list
Cluster: prod-cluster (c1bbabf3-cad1-4a59-ab8f-84e2a73b623f)
╭─────────────────────────────────────────────────────────────┬───────────┬────────────────────────────────┬────────╮
│ Task                                                        │ Arguments │ Next run                       │ Status │
├─────────────────────────────────────────────────────────────┼───────────┼────────────────────────────────┼────────┤
│ healthcheck/96e94236-5358-4302-ae9a-39ab84e383e8            │           │ 08 Oct 20 10:51:01 CEST (+15s) │ DONE   │
│ healthcheck_alternator/f051f529-ddd7-487d-a36d-d015eb140803 │           │ 08 Oct 20 10:51:01 CEST (+15s) │ DONE   │
│ healthcheck_rest/9fdcc415-7923-4acf-be64-fa85a6952bce       │           │ 08 Oct 20 10:51:46 CEST (+1m)  │ NEW    │
│ repair/fb57446f-2adc-442e-802d-2cbc24dcc5b2                 │           │ 09 Oct 20 00:00:00 CEST (+7d)  │ NEW    │
╰─────────────────────────────────────────────────────────────┴───────────┴────────────────────────────────┴────────╯
</pre></div>
</div>
<p>You will see 4 tasks which are created by adding the cluster:</p>
<ul class="simple">
<li><p>Healthcheck - which checks the Scylla CQL, repeating every 15 seconds.</p></li>
<li><p>Healthcheck Alternator - which checks the Scylla Alternator API, repeating every 15 seconds.</p></li>
<li><p>Healthcheck REST - which checks the Scylla REST API, repeating every minute.</p></li>
<li><p>Repair - an automated repair task, starting at midnight tonight, repeating every seven days at midnight.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to change the schedule for the repair, use the <a class="reference internal" href="sctool/repair.html#reschedule-a-repair"><span class="std std-ref">repair update sctool</span></a> command.</p>
</div>
</li>
<li><p>Verify Scylla Manager can communicate with all the Agents, and the the cluster status is OK by running the <code class="docutils literal notranslate"><span class="pre">sctool</span> <span class="pre">status</span></code> command.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool status
Cluster: prod-cluster (c1bbabf3-cad1-4a59-ab8f-84e2a73b623f)
╭────┬────────────┬───────────┬───────────┬───────────────┬────────┬──────┬──────────┬────────┬──────────┬──────────────────────────────────────╮
│    │ Alternator │ CQL       │ REST      │ Address       │ Uptime │ CPUs │ Memory   │ Scylla │ Agent    │ Host ID                              │
├────┼────────────┼───────────┼───────────┼───────────────┼────────┼──────┼──────────┼────────┼──────────┼──────────────────────────────────────┤
│ UN │ UP (4ms)   │ UP (3ms)  │ UP (2ms)  │ 34.203.122.52 │ 2m1s   │ 4    │ 15.43GiB │ 4.1.0  │ 2.2.0    │ 8bfd18f1-ac3b-4694-bcba-30bc272554df │
│ UN │ UP (15ms)  │ UP (11ms) │ UP (12ms) │ 10.0.138.46   │ 2m1s   │ 4    │ 15.43GiB │ 4.1.0  │ 2.2.0    │ 238acd01-813c-4c55-bd65-5219bb19bc20 │
│ UN │ UP (17ms)  │ UP (5ms)  │ UP (7ms)  │ 10.0.196.204  │ 2m1s   │ 4    │ 15.43GiB │ 4.1.0  │ 2.2.0    │ bde4581a-b25e-49fc-8cd9-1651d7683f80 │
│ UN │ UP (10ms)  │ UP (4ms)  │ UP (5ms)  │ 10.0.66.115   │ 2m1s   │ 4    │ 15.43GiB │ 4.1.0  │ 2.2.0    │ 918a52aa-cc42-43a4-a499-f7b1ccb53b18 │
╰────┴────────────┴───────────┴───────────┴───────────────┴────────┴──────┴──────────┴────────┴──────────┴──────────────────────────────────────╯
</pre></div>
</div>
</li>
</ol>
</div>

        </div>

        <div id="sidebar" class="large-3 large-pull-6 columns"><div class="side-nav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install-scylla-manager.html">Install Scylla Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-scylla-manager-agent.html">Install Scylla Manager Agent</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Add a Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="backup/index.html">Backup</a></li>
<li class="toctree-l1"><a class="reference internal" href="restore/index.html">Restore</a></li>
<li class="toctree-l1"><a class="reference internal" href="repair/index.html">Repair</a></li>
<li class="toctree-l1"><a class="reference internal" href="health-check.html">Health Check</a></li>
<li class="toctree-l1"><a class="reference internal" href="sctool/index.html">CLI sctool</a></li>
<li class="toctree-l1"><a class="reference internal" href="config/index.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="scylla-monitoring.html">Scylla Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="older-versions.html">Older Versions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://scylladb-users.slack.com/archives/C01ERVBPWLU">Slack</a></li>
</ul>

</div>
        </div>

        <div class="large-3 columns">
            
        </div>

    </div>
</section>

<!-- newsleter modal -->

<div id="newsletter_signup" class="reveal-modal tiny radius dark_modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">×</a>
    <h2 id="modalTitle">Sign up for the Scylla newsletter</h2>
    <div id="mc_embed_signup">
        <form action="//cloudius-systems.us10.list-manage.com/subscribe/post?u=df8bb543c68230d5f7b4dcf78&amp;id=9a4589f144" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
            <div id="mc_embed_signup_scroll">

                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-EMAIL">Email</label></div>
                        <div class="small-9 columns"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-FNAME">First Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="FNAME" class="" id="mce-FNAME"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-LNAME">Last Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="LNAME" class="" id="mce-LNAME"></div>
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_df8bb543c68230d5f7b4dcf78_9a4589f144" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" class="button" value="Sign up" name="subscribe" id="mc-embedded-subscribe"></div>
            </div>
        </form>
    </div>
</div>

<!-- end newsleter modal -->



<!-- footer.html -->
<footer id="footer">
    <div class="footer-top">
        <a class="logo" href="https://www.scylladb.com"><img src="_static/img/logo-scylla-horizontal-RGB.svg" alt=""></a>
        <div class="footer-links">
            <a class="link" href="https://docs.scylladb.com">Docs</a>
            <a class="link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
            <a class="link" href="https://www.scylladb.com/company/">About Us</a>
            <a class="link button" href="https://github.com/scylladb/scylla-manager-issues/issues/new?title=Issue in page Add a Cluster&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://scylladb.github.io/scylla-manager/branch-2.2/add-a-cluster%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix" target="_blank">
                Report an issue on this page</a>
        </div>
        <div class="footer-actions">
            <a class="link-icon" href="https://github.com/ScyllaDB" target="_blank">
                <span class="icon-github2"></span></a>
            <a class="link-icon" href="https://twitter.com/ScyllaDB" target="_blank">
                <span class="icon-twitter"></span></a>
            <a class="link-icon" href="https://www.linkedin.com/company/scylladb"  target="_blank">
                <span class="icon-linkedin2"></span></a>
            <a class="link-icon" href="https://www.facebook.com/scylladb/" target="_blank">
                <span class="icon-facebook"></span></a>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-info">
            <div class="footer-copyright">
                &#169; 2020, ScyllaDB. All rights reserved.
            </div>
            <div class="footer-last-updated">
                Last updated on 14 December 2020.
            </div>
        </div>
        <div class="footer-links">
        </div>
    </div>
</footer>
<!-- end footer.html -->

<!-- bodyscripts.html -->
<!-- at the end of the BODY --> 
<script src="_static/js/vendor/jquery.js"></script>
<script src="_static/js/vendor/jquery.cookie.min.js"></script>
<script src="_static/expertrec.js"></script>
<script src="_static/js/foundation/foundation.js"></script>
<script src="_static/js/foundation/foundation.topbar.js"></script>
<script src="_static/app.js"></script>
<script>
    $(document).foundation();
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- end bodyscripts.html -->
</body>
</html>