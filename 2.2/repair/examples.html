


<!doctype html>
<html class="no-js" lang="en">
  
<head><!-- begin head.html -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
    Examples | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server."/>

    <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://docs.scylladb.com/">

    <link rel="author" href="mailto:info@scylladb.com">
    <link rel="stylesheet" href="../_static/" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_tabs/tabs.css" />
    
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>

    <script src="../_static/js/vendor/modernizr.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8P2JP');</script>
    <!-- End Google Tag Manager -->

    <!-- Marketo -->
    <script type="text/javascript"> (function() { var didInit = false; function initMunchkin() { if(didInit === false) { didInit = true; Munchkin.init('791-QBF-350'); } } var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//munchkin.marketo.net/munchkin.js'; s.onreadystatechange = function() { if (this.readyState == 'complete' || this.readyState == 'loaded') { initMunchkin(); } }; s.onload = initMunchkin; document.getElementsByTagName('head')[0].appendChild(s); })(); </script>
    <!-- End Marketo -->

<!-- end head.html -->
</head>

<body>


    <section class="custom-promo-banner-wrap">
    <div class="custom-promo-banner--relative">
        <div class="custom-promo-banner--img-left">
            <img src="../_static/img/Scylla-Summit-Banner-globs-left.svg">
        </div>
        <div class="custom-promo-banner--img-center">
            <img src="../_static/img/Scylla-Summit-Banner-globs-middle.svg">
        </div>
        <div class="custom-promo-banner--img-right">
            <img src="../_static/img/Scylla-Summit-Banner-globs-right.svg">
        </div>

        <div class="custom-promo-banner">
            <img class="custom-promo-banner--logo" src="../_static/img/slide-summit21-logo@2x.png" alt="">
            <div class="custom-promo-banner--title summit">Database Monsters of the World Connect! Virtual Conference | January 12-14</div>
            <a class="custom-promo-banner--button summit" href="https://scylladb.com/scylla-summit-2021/">Register Now <i class="fa fa-angle-right" style="margin-left: 10px;" aria-hidden="true"></i></a><button class="custom-promo-banner--close">×</button>
        </div>
    </div>
</section>



<header id="header" class="animated">
    <div class="topbar_continer contain-to-grid clearfix">
        <nav class="top-bar" id="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <div class="logo">
                        <a href="https://docs.scylladb.com/"><img src="../_static/img/logo-scylla-docs.svg" alt="" width="151"></a>
                    </div>
                </li>
                <li class="toggle-topbar"><a href="#"><span class="icon-manu"></span></a></li>
            </ul>
            <section class="top-bar-section clearfix">
                <ul class="right">
                    
                    <li>
                        <a href="https://scylladb.github.io/scylla-manager/">Scylla Manager</a>
                    </li>
                    
                    <li>
                        <a href="https://scylladb.github.io/scylla-monitoring/">Scylla Monitor</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">Scylla Cloud</a>
                    </li>
                    
                    <li>
                        <a href="https://university.scylladb.com/">Scylla University</a>
                    </li>
                    
                    <li>
                        <a href="https://www.scylladb.com/">ScyllaDB Home</a>
                    </li>
                    
                    <li class="search_continer show-for-medium-up">	
                        <ci-search></ci-search>	
                    </li>	
                </ul>
            </section>
        </nav>
    </div>
</header>
<section id="content">
    <div class="row">
	
	<div class="large-6 large-push-3 columns">

        

        <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#schedule-a-repair" id="id2">Schedule a repair</a></p></li>
<li><p><a class="reference internal" href="#create-an-ad-hoc-repair" id="id3">Create an ad-hoc repair</a></p></li>
<li><p><a class="reference internal" href="#perform-a-dry-run-of-a-repair" id="id4">Perform a dry run of a repair</a></p></li>
<li><p><a class="reference internal" href="#monitor-progress-of-the-repair-task" id="id5">Monitor progress of the repair task</a></p></li>
</ul>
</div>
<p>This document contains examples for scheduling and running repairs.</p>
<div class="section" id="schedule-a-repair">
<span id="id1"></span><h2><a class="toc-backref" href="#id2">Schedule a repair</a><a class="headerlink" href="#schedule-a-repair" title="Permalink to this headline">¶</a></h2>
<p>A cluster, added to Scylla Manager, has a repair task created for it.
This task repairs the entire cluster every week.
You can change it, add additional repairs, or delete it.
You can schedule repairs to run in the future on a regular basis or schedule repairs to run once as you need them.
Any repair can be rescheduled, paused, resumed, or deleted.</p>
<div class="section" id="create-a-scheduled-repair">
<h3>Create a scheduled repair<a class="headerlink" href="#create-a-scheduled-repair" title="Permalink to this headline">¶</a></h3>
<p>While the most recommended way to run a repair is across an entire cluster, repairs can be scheduled to run on a single/multiple datacenters, keyspaces, or tables.
The selection mechanism, based on the glob patterns, gives you a lot of flexibility.
Scheduled repairs run every X days depending on the frequency you set.
Additional parameters are described in the <a class="reference internal" href="../sctool/repair.html#repair-commands"><span class="std std-ref">sctool repair</span></a> command reference.</p>
<p>Use the example below to run the sctool repair command.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c &lt;id|name&gt; [-s &lt;date&gt;] [-i &lt;time-unit&gt;]
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> - the <a class="reference internal" href="../sctool/cluster.html#cluster-add"><span class="std std-ref">name</span></a> you used when you created the cluster</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-s</span></code> - the time you want the repair to begin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-i</span></code> - the time interval you want to use in between consecutive repairs</p></li>
</ul>
<p>The command returns the task ID. You will need this ID for additional actions.
If you want to run the repair only once, leave out the interval argument (<code class="docutils literal notranslate"><span class="pre">-i</span></code>).
In case when you want the repair to start immediately, but you want it to schedule it to repeat at a determined interval, leave out the start flag (<code class="docutils literal notranslate"><span class="pre">-s</span></code>) and set the interval flag (<code class="docutils literal notranslate"><span class="pre">-i</span></code>) to the time you want the repair to reoccur.</p>
<div class="section" id="schedule-a-weekly-repair">
<h4>Schedule a weekly repair<a class="headerlink" href="#schedule-a-weekly-repair" title="Permalink to this headline">¶</a></h4>
<p>This command will schedule a repair in 4 hours, repair will be repeated every week.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster -s now+4h -i 7d
repair/41014974-f7a7-4d67-b75c-44f59cdc5105
</pre></div>
</div>
<p>Command returns the task ID (repair/41014974-f7a7-4d67-b75c-44f59cdc5105, in this case).
This ID can be used to query the status of the repair task, to defer the task to another time, or to cancel the task See <a class="reference internal" href="../sctool/task.html#task-commands"><span class="std std-ref">Managing Tasks</span></a>.</p>
</div>
</div>
<div class="section" id="schedule-a-repair-for-a-specific-dc-keyspace-or-table">
<h3>Schedule a repair for a specific DC, keyspace, or table<a class="headerlink" href="#schedule-a-repair-for-a-specific-dc-keyspace-or-table" title="Permalink to this headline">¶</a></h3>
<p>In order to schedule repair of particular data center, you have to specify <code class="docutils literal notranslate"><span class="pre">--dc</span></code> parameter.
You can specify more than one DC, or use glob pattern to match multiple DCs or exclude some of them.</p>
<p>For Example, you have the following DCs in your cluster: dc1, dc2, dc3</p>
<div class="section" id="repair-one-specific-dc">
<h4>Repair one specific DC<a class="headerlink" href="#repair-one-specific-dc" title="Permalink to this headline">¶</a></h4>
<p>In this example, only dc1 is repaired. The repair repeats every 5 days.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster -i 5d --dc &#39;dc1&#39;
</pre></div>
</div>
</div>
<div class="section" id="repair-all-dcs-except-for-those-specified">
<h4>Repair all DCs except for those specified<a class="headerlink" href="#repair-all-dcs-except-for-those-specified" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster -i 5d --dc &#39;*,!dc2&#39;
</pre></div>
</div>
</div>
<div class="section" id="repair-a-specific-keyspace-or-table">
<h4>Repair a specific keyspace or table<a class="headerlink" href="#repair-a-specific-keyspace-or-table" title="Permalink to this headline">¶</a></h4>
<p>In order to schedule repair of particular keyspace or table, you have to provide <code class="docutils literal notranslate"><span class="pre">-K</span></code> parameter.
You can specify more than one keyspace/table or use glob pattern to match multiple keyspaces/tables or exclude them.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster -K &#39;auth_service.*,!auth_service.lru_cache&#39; --dc &#39;dc1&#39;
</pre></div>
</div>
</div>
<div class="section" id="repair-a-specific-node">
<h4>Repair a specific node<a class="headerlink" href="#repair-a-specific-node" title="Permalink to this headline">¶</a></h4>
<p>In this example, you repair only token ranges replicated by the node with IP <code class="docutils literal notranslate"><span class="pre">34.203.122.52</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster --host 34.203.122.52
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-an-ad-hoc-repair">
<h2><a class="toc-backref" href="#id3">Create an ad-hoc repair</a><a class="headerlink" href="#create-an-ad-hoc-repair" title="Permalink to this headline">¶</a></h2>
<p>An ad-hoc repair runs immediately and does not repeat.
This procedure shows the most frequently used repair commands.
Additional parameters can be used. Refer to <a class="reference internal" href="../sctool/repair.html#repair-parameters"><span class="std std-ref">repair parameters</span></a>.</p>
<p><strong>Procedure</strong></p>
<p>To run an immediate repair on the prod-cluster cluster, saving the repair in my-repairs, run the following command
replacing the <code class="docutils literal notranslate"><span class="pre">-c</span></code> cluster flag with your cluster’s cluster name or ID and replace the <code class="docutils literal notranslate"><span class="pre">-L</span></code> flag with your repair’s location:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster -L &#39;s3:my-repairs&#39;
</pre></div>
</div>
</div>
<div class="section" id="perform-a-dry-run-of-a-repair">
<h2><a class="toc-backref" href="#id4">Perform a dry run of a repair</a><a class="headerlink" href="#perform-a-dry-run-of-a-repair" title="Permalink to this headline">¶</a></h2>
<p>We recommend to use <code class="docutils literal notranslate"><span class="pre">--dry-run</span></code> parameter prior scheduling a repair if you specify datacenter, keyspace or table filters.
It’s a useful way to verify that all the data you want will be repaired.
Add the parameter to the end of your repair command, so if it works, you can erase it and schedule the repair with no need to make any other changes.
If you do tables filtering you can pass <code class="docutils literal notranslate"><span class="pre">--show-tables</span></code> flag in order to print the table names next to keyspaces.</p>
<p>If the dry run completes successfully, a summary of the repair is displayed. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool repair -c prod-cluster -K system*,test_keyspace.* --dry-run
NOTICE: dry run mode, repair is not scheduled

Token Ranges:
Data Centers:
  - AWS_EU_CENTRAL_1

Keyspaces:
  - system_auth (3 tables)
  - system_distributed (3 tables)
  - system_traces (5 tables)
  - test_keyspace (10 tables)
</pre></div>
</div>
<p>Note that if a keyspace has no tables or a table is empty it will not be listed here.
Nevertheless you can still schedule the repair, the glob patterns are evaluated before each repair run so when data is there it will be repaired.</p>
</div>
<div class="section" id="monitor-progress-of-the-repair-task">
<h2><a class="toc-backref" href="#id5">Monitor progress of the repair task</a><a class="headerlink" href="#monitor-progress-of-the-repair-task" title="Permalink to this headline">¶</a></h2>
<p>Progress of the repair task can be monitored by using the <a class="reference internal" href="../sctool/task.html#task-progress"><span class="std std-ref">sctool task progress</span></a> command and providing UUID of the repair task.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sctool task progress repair/143d160f-e53c-4890-a9e7-149561376cfd -c prod-cluster
</pre></div>
</div>
</div>
</div>

        </div>

        <div id="sidebar" class="large-3 large-pull-6 columns"><div class="side-nav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install-scylla-manager.html">Install Scylla Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install-scylla-manager-agent.html">Install Scylla Manager Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../add-a-cluster.html">Add a Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backup/index.html">Backup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../restore/index.html">Restore</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Repair</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="repair-faster.html">Repair faster</a></li>
<li class="toctree-l2"><a class="reference internal" href="repair-slower.html">Repair slower</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../health-check.html">Health Check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sctool/index.html">CLI sctool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scylla-monitoring.html">Scylla Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../older-versions.html">Older Versions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://scylladb-users.slack.com/archives/C01ERVBPWLU">Slack</a></li>
</ul>

</div>
        </div>

        <div class="large-3 columns">
            
        </div>

    </div>
</section>

<!-- newsleter modal -->

<div id="newsletter_signup" class="reveal-modal tiny radius dark_modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">×</a>
    <h2 id="modalTitle">Sign up for the Scylla newsletter</h2>
    <div id="mc_embed_signup">
        <form action="//cloudius-systems.us10.list-manage.com/subscribe/post?u=df8bb543c68230d5f7b4dcf78&amp;id=9a4589f144" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
            <div id="mc_embed_signup_scroll">

                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-EMAIL">Email</label></div>
                        <div class="small-9 columns"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-FNAME">First Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="FNAME" class="" id="mce-FNAME"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-LNAME">Last Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="LNAME" class="" id="mce-LNAME"></div>
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_df8bb543c68230d5f7b4dcf78_9a4589f144" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" class="button" value="Sign up" name="subscribe" id="mc-embedded-subscribe"></div>
            </div>
        </form>
    </div>
</div>

<!-- end newsleter modal -->



<!-- footer.html -->
<footer id="footer">
    <div class="footer-top">
        <a class="logo" href="https://www.scylladb.com"><img src="../_static/img/logo-scylla-horizontal-RGB.svg" alt=""></a>
        <div class="footer-links">
            <a class="link" href="https://docs.scylladb.com">Docs</a>
            <a class="link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
            <a class="link" href="https://www.scylladb.com/company/">About Us</a>
            <a class="link button" href="https://github.com/scylladb/scylla-manager-issues/issues/new?title=Issue in page Examples&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://scylladb.github.io/scylla-manager/branch-2.2/repair/examples%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix" target="_blank">
                Report an issue on this page</a>
        </div>
        <div class="footer-actions">
            <a class="link-icon" href="https://github.com/ScyllaDB" target="_blank">
                <span class="icon-github2"></span></a>
            <a class="link-icon" href="https://twitter.com/ScyllaDB" target="_blank">
                <span class="icon-twitter"></span></a>
            <a class="link-icon" href="https://www.linkedin.com/company/scylladb"  target="_blank">
                <span class="icon-linkedin2"></span></a>
            <a class="link-icon" href="https://www.facebook.com/scylladb/" target="_blank">
                <span class="icon-facebook"></span></a>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-info">
            <div class="footer-copyright">
                &#169; 2020, ScyllaDB. All rights reserved.
            </div>
            <div class="footer-last-updated">
                Last updated on 14 December 2020.
            </div>
        </div>
        <div class="footer-links">
        </div>
    </div>
</footer>
<!-- end footer.html -->

<!-- bodyscripts.html -->
<!-- at the end of the BODY --> 
<script src="../_static/js/vendor/jquery.js"></script>
<script src="../_static/js/vendor/jquery.cookie.min.js"></script>
<script src="../_static/expertrec.js"></script>
<script src="../_static/js/foundation/foundation.js"></script>
<script src="../_static/js/foundation/foundation.topbar.js"></script>
<script src="../_static/app.js"></script>
<script>
    $(document).foundation();
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- end bodyscripts.html -->
</body>
</html>